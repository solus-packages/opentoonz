name       : opentoonz
version    : 1.2.1
release    : 1
homepage   : https://opentoonz.github.io/
source     :
    - https://github.com/opentoonz/opentoonz/archive/v1.2.1.tar.gz : 3f91328502c0ad4fa6a9905f6f5a5490c8d589f07bd3d8be1410849573a26b22
license    :
    - BSD-3-Clause
    - CC0-1.0 # bundled brushes
    - libtiff # internal libtiff
component  : multimedia.video
summary    : An open-source full-featured 2D animation creation software
description: |
    OpenToonz is a 2D animation software published by DWANGO. It is based on Toonz Studio Ghibli Version, originally developed in Italy by Digital Video, Inc., and customized by Studio Ghibli over many years of production.
builddeps  :
    - pkgconfig(freeglut)
    - pkgconfig(freetype2)
    - pkgconfig(glew)
    - pkgconfig(libjpeg)
    - pkgconfig(liblz4)
    - pkgconfig(libmypaint)
    - pkgconfig(libusb)
    - pkgconfig(openblas)
    - pkgconfig(Qt5Multimedia)
    - pkgconfig(Qt5Script)
    - pkgconfig(Qt5Svg)
    - pkgconfig(Qt5UiTools)
    - pkgconfig(sdl2)
    - imagemagick
    - libboost-devel
    - lzo-devel
    - superlu-devel
setup      : |
    # currently opentoonz needs its own modified version of libtiff
    cd thirdparty/tiff-4.0.3
    %configure --with-pic --disable-jbig
    %make

    cd ../../toonz
    %cmake sources
build      : |
    cd toonz
    %make
install    : |
    cd toonz
    %make_install

    install -d $installdir/usr/share/applications
    install -Dm00644 $pkgfiles/opentoonz.desktop $installdir/usr/share/applications/opentoonz.desktop

    install -d $installdir/usr/share/pixmaps
    convert sources/toonz/toonz.ico[4] $installdir/usr/share/pixmaps/toonz.png